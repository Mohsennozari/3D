<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نمایش متن سه بعدی</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
        #input-container {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1;
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        #input-container input, #input-container button {
            margin: 5px;
        }
    </style>
</head>
<body>
    <div id="input-container">
        <input type="text" id="text-input" placeholder="متن خود را وارد کنید">
        <input type="color" id="color-input" value="#00ff00">
        <input type="number" id="size-input" placeholder="اندازه متن" min="0.1" max="2" step="0.1" value="0.5">
        <button onclick="create3DText()">نمایش</button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer, textMesh;
        let isDragging = false; // وضعیت کلیک و نگه‌داشتن موس
        let previousMousePosition = { x: 0, y: 0 }; // موقعیت قبلی موس

        function init() {
            // ایجاد صحنه
            scene = new THREE.Scene();

            // ایجاد دوربین
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            // ایجاد رندرر
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // افزودن نور
            const light = new THREE.DirectionalLight(0xffffff, 1);
            light.position.set(1, 1, 1).normalize();
            scene.add(light);
        }

        function create3DText() {
            const text = document.getElementById('text-input').value;
            const color = document.getElementById('color-input').value;
            const size = parseFloat(document.getElementById('size-input').value);

            if (textMesh) {
                scene.remove(textMesh);
            }

            const fontLoader = new THREE.FontLoader();
            fontLoader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function (font) {
                const geometry = new THREE.TextGeometry(text, {
                    font: font,
                    size: size,
                    height: 0.2,
                });

                const material = new THREE.MeshPhongMaterial({ color: color });
                textMesh = new THREE.Mesh(geometry, material);
                textMesh.position.set(-text.length * size * 0.25, 0, 0); // تنظیم موقعیت متن
                scene.add(textMesh);
            });
        }

        function onMouseDown(event) {
            isDragging = true; // شروع درگ کردن
            previousMousePosition = {
                x: event.clientX,
                y: event.clientY
            };
        }

        function onMouseMove(event) {
            if (isDragging && textMesh) {
                const deltaX = event.clientX - previousMousePosition.x;
                const deltaY = event.clientY - previousMousePosition.y;

                // چرخش متن بر اساس حرکت موس
                textMesh.rotation.y += deltaX * 0.01;
                textMesh.rotation.x += deltaY * 0.01;

                // به‌روزرسانی موقعیت قبلی موس
                previousMousePosition = {
                    x: event.clientX,
                    y: event.clientY
                };
            }
        }

        function onMouseUp() {
            isDragging = false; // پایان درگ کردن
        }

        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }

        // افزودن رویدادهای موس
        document.addEventListener('mousedown', onMouseDown);
        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup', onMouseUp);

        init();
        animate();
    </script>
</body>
</html>
